import{r as a,j as e}from"./ui-vendor-rA8IexKS.js";import{A as ge,l as xe,a as he,b as ye,c as ue,d as pe,e as fe,f as be,g as je,T as Ie,S as Oe,H as Ee,m as Fe,n as Ue,o as _,q as M}from"./TranscriptionConfigDialog-B7WsbJmu.js";import{u as L,B as S,L as w,I as A,C as re,i as le,j as ne,e as ie,k as de}from"./index-hSqt8rb2.js";import{P as ve,a as Ne,b as ke,S as _e,T as we}from"./textarea-Bups9Y6L.js";import{N as W,Q as Me,h as $e,T as G,R as Ce,E as H,a as R,W as Ke,C as q,X as oe,Y as He,b as Re,Z as qe,t as ze,_ as V,d as ce,p as me,$ as Je,a0 as Se,B as Y,O as Be}from"./lucide-vendor-DI6dXaZX.js";import{S as Pe,a as Ae,b as De,c as Te,d as Le}from"./select-CtZYfv8r.js";import{D as X,a as Z,b as Q,c as ee,d as ae,e as se}from"./index-DHJEQtTr.js";import"./react-vendor-gH-7aFTg.js";function Ve({refreshTrigger:n,onProfileChange:p,onEditProfile:t,onCreateProfile:i}){const{getAuthHeaders:g}=L(),[m,f]=a.useState([]),[u,j]=a.useState(!0),[x,d]=a.useState({}),[N,r]=a.useState(new Set),l=a.useCallback(async()=>{try{j(!0);const s=await fetch("/api/v1/profiles",{headers:{...g()}});if(s.ok){const c=await s.json();f(c)}else console.error("Failed to fetch profiles")}catch(s){console.error("Error fetching profiles:",s)}finally{j(!1)}},[]);a.useEffect(()=>{l()},[n,l]);const h=a.useCallback(async s=>{d(c=>({...c,[s]:!1}));try{r(y=>new Set(y).add(s)),(await fetch(`/api/v1/profiles/${s}`,{method:"DELETE",headers:{...g()}})).ok?p():alert("Failed to delete profile")}catch{alert("Error deleting profile")}finally{r(c=>{const y=new Set(c);return y.delete(s),y})}},[p]),o=a.useCallback(s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),[]);return u?e.jsx("div",{className:"space-y-2",children:[...Array(3)].map((s,c)=>e.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 rounded-lg p-4 animate-pulse",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-6 w-6 bg-gray-200 dark:bg-gray-600 rounded-md"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-600 rounded w-1/3"}),e.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-600 rounded w-1/2"})]}),e.jsx("div",{className:"h-6 w-6 bg-gray-200 dark:bg-gray-600 rounded"})]})},c))}):m.length===0?e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"bg-gray-100 dark:bg-gray-700 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx(W,{className:"h-8 w-8 text-gray-400 dark:text-gray-500"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"No profiles yet"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6 max-w-sm mx-auto",children:"Create your first transcription profile to save and reuse your preferred settings."}),e.jsx(S,{onClick:()=>i?.(),variant:"outline",className:"border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-400",children:"Create Profile"})]}):e.jsx("div",{className:"space-y-2",children:m.map(s=>e.jsx("div",{className:"group bg-gray-100 dark:bg-gray-700 rounded-lg p-4 hover:bg-gray-200 dark:hover:bg-gray-600 transition-all duration-200 cursor-pointer",onClick:()=>t(s),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"bg-gray-200 dark:bg-gray-800 rounded-md p-1.5",children:e.jsx(Me,{className:"h-3.5 w-3.5 text-gray-500 dark:text-gray-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:s.name}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 whitespace-nowrap",children:o(s.created_at)})]}),s.description&&e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate mt-1",children:s.description})]})]}),e.jsx("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity duration-200",onClick:c=>c.stopPropagation(),children:e.jsxs(ve,{open:x[s.id]||!1,onOpenChange:c=>d(y=>({...y,[s.id]:c})),children:[e.jsx(Ne,{asChild:!0,children:e.jsx(S,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 hover:bg-gray-300 dark:hover:bg-gray-600",children:e.jsx($e,{className:"h-3.5 w-3.5"})})}),e.jsx(ke,{className:"w-32 bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-600 p-1",children:e.jsxs(ge,{children:[e.jsx(xe,{asChild:!0,children:e.jsxs(S,{variant:"ghost",size:"sm",className:"w-full justify-start h-7 text-xs hover:bg-gray-100 dark:hover:bg-gray-700 text-red-500 dark:text-red-400 hover:text-red-600 dark:hover:text-red-300",disabled:N.has(s.id),children:[e.jsx(G,{className:"mr-2 h-3 w-3"}),"Delete"]})}),e.jsxs(he,{className:"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:[e.jsxs(ye,{children:[e.jsx(ue,{className:"text-gray-900 dark:text-gray-100",children:"Delete Profile"}),e.jsxs(pe,{className:"text-gray-600 dark:text-gray-400",children:['Are you sure you want to delete "',s.name,'"? This action cannot be undone.']})]}),e.jsxs(fe,{children:[e.jsx(be,{className:"bg-gray-100 dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-600",children:"Cancel"}),e.jsx(je,{className:"bg-red-600 text-white hover:bg-red-700",onClick:()=>h(s.id),children:"Delete"})]})]})]})})]})})]})},s.id))})}function Ye(){const[n,p]=a.useState(!1),[t,i]=a.useState(null),[g,m]=a.useState(0),[f,u]=a.useState([]),[j,x]=a.useState(null),[d,N]=a.useState(!0),{getAuthHeaders:r}=L(),[l,h]=a.useState(null),[o,s]=a.useState(!0),[c,y]=a.useState(""),[D,O]=a.useState(""),$=a.useCallback(async()=>{try{N(!0);const v=await fetch("/api/v1/profiles",{headers:r()});if(v.ok){const C=await v.json();u(C)}const b=await fetch("/api/v1/user/default-profile",{headers:r()});if(b.ok){const C=await b.json();x(C)}else b.status===404&&x(null)}catch(v){console.error("Failed to load profiles:",v)}finally{N(!1)}},[r]),U=a.useCallback(async v=>{try{const b=await fetch("/api/v1/user/default-profile",{method:"POST",headers:{"Content-Type":"application/json",...r()},body:JSON.stringify({profile_id:v})});if(b.ok){const C=f.find(K=>K.id===v);x(C||null)}else{const C=await b.text();console.error("Failed to set default profile:",C),alert("Failed to set default profile")}}catch(b){console.error("Failed to set default profile:",b),alert("Failed to set default profile")}},[f,r]);a.useEffect(()=>{$()},[$,g]),a.useEffect(()=>{(async()=>{try{const b=await fetch("/api/v1/user/settings",{headers:r()});if(b.ok){const C=await b.json();h(C)}else console.error("Failed to load user settings")}catch(b){console.error("Error loading user settings:",b)}finally{s(!1)}})()},[r]);const z=async v=>{y(""),O("");try{const b=await fetch("/api/v1/user/settings",{method:"PUT",headers:{"Content-Type":"application/json",...r()},body:JSON.stringify({auto_transcription_enabled:v})});if(b.ok){const C=await b.json();h(C),O(`Auto-transcription ${v?"enabled":"disabled"} successfully!`)}else{const C=await b.json();y(C.error||"Failed to update setting")}}catch(b){console.error("Error updating auto-transcription setting:",b),y("Network error. Please try again.")}},E=a.useCallback(()=>{i(null),p(!0)},[]),J=a.useCallback(v=>{i(v),p(!0)},[]),te=a.useCallback(async v=>{try{const b=(v.profileName||"").trim(),C=(v.profileDescription||"").trim();if(!b){alert("Profile name is required");return}const{profileName:K,profileDescription:F,...k}=v,P={name:b,description:C||void 0,parameters:k};let T;if(t?T=await fetch(`/api/v1/profiles/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json",...r()},body:JSON.stringify({...P,id:t.id,is_default:t.is_default})}):T=await fetch("/api/v1/profiles",{method:"POST",headers:{"Content-Type":"application/json",...r()},body:JSON.stringify(P)}),!T.ok){const B=await T.text();alert(`Failed to save profile: ${T.status} ${B}`);return}m(B=>B+1),p(!1),i(null)}catch(b){console.error("Failed to save profile",b),alert("Failed to save profile")}},[t,r]),I=a.useCallback(()=>{m(v=>v+1)},[]);return e.jsxs("div",{className:"space-y-6",children:[c&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-3",children:e.jsx("p",{className:"text-red-700 dark:text-red-300 text-sm",children:c})}),D&&e.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-3",children:e.jsx("p",{className:"text-green-700 dark:text-green-300 text-sm",children:D})}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-xl p-4 sm:p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(W,{className:"h-5 w-5 text-green-600 dark:text-green-400"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:"Auto-Transcription"})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Configure automatic transcription behavior for uploaded files."})]}),o?e.jsxs("div",{className:"flex items-center space-x-2 py-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Loading settings..."})]}):e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsxs("div",{children:[e.jsx(w,{htmlFor:"auto-transcription",className:"text-gray-700 dark:text-gray-300 font-medium",children:"Automatic Transcription on Upload"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"When enabled, uploaded audio files will automatically be queued for transcription using your default profile."})]}),e.jsx(_e,{id:"auto-transcription",checked:l?.auto_transcription_enabled||!1,onCheckedChange:z,disabled:o})]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-xl p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-0 mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:"Transcription Profiles"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Manage your saved transcription configurations for quick access."})]}),e.jsx(S,{onClick:E,className:"bg-blue-600 hover:bg-blue-700 text-white",children:"Create New Profile"})]}),e.jsx("div",{className:"mb-6 p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Default Profile"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"The profile to use by default when starting new transcriptions."})]}),e.jsx("div",{className:"w-full sm:w-64",children:e.jsxs(Pe,{value:j?.id||"",onValueChange:U,disabled:d||f.length===0,children:[e.jsx(Ae,{children:e.jsx(De,{placeholder:d?"Loading...":f.length===0?"No profiles available":"Select default profile"})}),e.jsx(Te,{children:f.map(v=>e.jsx(Le,{value:v.id,children:v.name},v.id))})]})})]})}),e.jsx(Ve,{refreshTrigger:g,onProfileChange:I,onEditProfile:J,onCreateProfile:E})]}),e.jsx(Ie,{open:n,onOpenChange:v=>{p(v),v||i(null)},onStartTranscription:te,isProfileMode:!0,initialParams:t?.parameters,initialName:t?.name,initialDescription:t?.description})]})}function We(){const{getAuthHeaders:n,logout:p}=L(),[t,i]=a.useState(!1),[g,m]=a.useState(""),[f,u]=a.useState(""),[j,x]=a.useState(""),[d,N]=a.useState(""),[r,l]=a.useState(!1),[h,o]=a.useState(""),[s,c]=a.useState(""),[y,D]=a.useState(""),[O,$]=a.useState(!1),[U,z]=a.useState(!1),[E,J]=a.useState(!1),I=(k=>({hasMinLength:k.length>=8,hasUppercase:/[A-Z]/.test(k),hasLowercase:/[a-z]/.test(k),hasNumber:/\d/.test(k),hasSpecialChar:/[!@#$%^&*(),.?":{}|<>]/.test(k)}))(s),v=Object.values(I).every(Boolean),b=s===y&&y.length>0,C=async k=>{k.preventDefault(),m(""),u(""),i(!0);try{const P=await fetch("/api/v1/auth/change-username",{method:"POST",headers:{"Content-Type":"application/json",...n()},body:JSON.stringify({newUsername:j,password:d})});if(P.ok)u("Username changed successfully!"),x(""),N("");else{const T=await P.json();m(T.error||"Failed to change username")}}catch(P){console.error("Username change error:",P),m("Network error. Please try again.")}finally{i(!1)}},K=async k=>{if(k.preventDefault(),m(""),u(""),!v){m("Please ensure your new password meets all requirements");return}if(!b){m("New passwords do not match");return}i(!0);try{const P=await fetch("/api/v1/auth/change-password",{method:"POST",headers:{"Content-Type":"application/json",...n()},body:JSON.stringify({currentPassword:h,newPassword:s,confirmPassword:y})});if(P.ok)u("Password changed successfully! You will be logged out shortly..."),o(""),c(""),D(""),setTimeout(()=>{p()},2e3);else{const T=await P.json();m(T.error||"Failed to change password")}}catch(P){console.error("Password change error:",P),m("Network error. Please try again.")}finally{i(!1)}},F=({label:k,met:P})=>e.jsxs("div",{className:`flex items-center gap-2 text-sm ${P?"text-green-600 dark:text-green-400":"text-gray-500 dark:text-gray-400"}`,children:[P?e.jsx(q,{className:"h-3 w-3"}):e.jsx(oe,{className:"h-3 w-3"}),e.jsx("span",{children:k})]});return e.jsxs("div",{className:"space-y-6",children:[g&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-3",children:e.jsx("p",{className:"text-red-700 dark:text-red-300 text-sm",children:g})}),f&&e.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-3",children:e.jsx("p",{className:"text-green-700 dark:text-green-300 text-sm",children:f})}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-xl p-4 sm:p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(Ce,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:"Change Username"})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Update your account username. You'll need to verify your current password."})]}),e.jsx("div",{children:e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"newUsername",className:"text-gray-700 dark:text-gray-300",children:"New Username"}),e.jsx(A,{id:"newUsername",type:"text",placeholder:"Enter new username (3-50 characters)",value:j,onChange:k=>x(k.target.value),disabled:t,required:!0,minLength:3,maxLength:50,className:"bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"usernamePassword",className:"text-gray-700 dark:text-gray-300",children:"Current Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(A,{id:"usernamePassword",type:r?"text":"password",placeholder:"Enter your current password",value:d,onChange:k=>N(k.target.value),disabled:t,required:!0,className:"bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100 pr-10"}),e.jsx("button",{type:"button",onClick:()=>l(!r),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:r?e.jsx(H,{className:"h-4 w-4"}):e.jsx(R,{className:"h-4 w-4"})})]})]}),e.jsx(S,{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white",disabled:t||!j.trim()||!d.trim(),children:t?"Changing Username...":"Change Username"})]})})]}),e.jsx(Oe,{className:"bg-gray-200 dark:bg-gray-700"}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-xl p-4 sm:p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(Ke,{className:"h-5 w-5 text-red-600 dark:text-red-400"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:"Change Password"})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Update your account password. You'll be automatically logged out after changing your password."})]}),e.jsx("div",{children:e.jsxs("form",{onSubmit:K,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"currentPassword",className:"text-gray-700 dark:text-gray-300",children:"Current Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(A,{id:"currentPassword",type:O?"text":"password",placeholder:"Enter your current password",value:h,onChange:k=>o(k.target.value),disabled:t,required:!0,className:"bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100 pr-10"}),e.jsx("button",{type:"button",onClick:()=>$(!O),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:O?e.jsx(H,{className:"h-4 w-4"}):e.jsx(R,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"newPassword",className:"text-gray-700 dark:text-gray-300",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(A,{id:"newPassword",type:U?"text":"password",placeholder:"Create a new secure password",value:s,onChange:k=>c(k.target.value),disabled:t,required:!0,className:"bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100 pr-10"}),e.jsx("button",{type:"button",onClick:()=>z(!U),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:U?e.jsx(H,{className:"h-4 w-4"}):e.jsx(R,{className:"h-4 w-4"})})]}),s&&e.jsxs("div",{className:"mt-3 space-y-2 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Password Requirements:"}),e.jsxs("div",{className:"grid grid-cols-1 gap-1",children:[e.jsx(F,{label:"At least 8 characters",met:I.hasMinLength}),e.jsx(F,{label:"One uppercase letter",met:I.hasUppercase}),e.jsx(F,{label:"One lowercase letter",met:I.hasLowercase}),e.jsx(F,{label:"One number",met:I.hasNumber}),e.jsx(F,{label:"One special character",met:I.hasSpecialChar})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"confirmPassword",className:"text-gray-700 dark:text-gray-300",children:"Confirm New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(A,{id:"confirmPassword",type:E?"text":"password",placeholder:"Confirm your new password",value:y,onChange:k=>D(k.target.value),disabled:t,required:!0,className:`bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100 pr-10 ${y&&!b?"border-red-300 dark:border-red-600":""}`}),e.jsx("button",{type:"button",onClick:()=>J(!E),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:E?e.jsx(H,{className:"h-4 w-4"}):e.jsx(R,{className:"h-4 w-4"})})]}),y&&e.jsxs("div",{className:`flex items-center gap-2 text-sm ${b?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:[b?e.jsx(q,{className:"h-3 w-3"}):e.jsx(oe,{className:"h-3 w-3"}),e.jsx("span",{children:b?"Passwords match":"Passwords do not match"})]})]}),e.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-3",children:[e.jsx("p",{className:"text-yellow-800 dark:text-yellow-300 text-sm font-medium",children:"⚠️ Warning"}),e.jsx("p",{className:"text-yellow-700 dark:text-yellow-300 text-sm mt-1",children:"You will be automatically logged out after changing your password and will need to log in again with your new credentials."})]}),e.jsx(S,{type:"submit",className:"bg-red-600 hover:bg-red-700 text-white",disabled:t||!h.trim()||!v||!b,children:t?"Changing Password...":"Change Password"})]})})]})]})}function Ge({refreshTrigger:n,onKeyChange:p}){const[t,i]=a.useState([]),[g,m]=a.useState(!0),[f,u]=a.useState(null),{getAuthHeaders:j}=L(),x=async()=>{try{const l=await fetch("/api/v1/api-keys/",{headers:j()});if(l.ok){const h=await l.json();i(h.api_keys||[])}else console.error("Failed to fetch API keys"),i([])}catch(l){console.error("Error fetching API keys:",l),i([])}finally{m(!1)}};a.useEffect(()=>{x()},[n]);const d=async l=>{if(confirm("Are you sure you want to delete this API key? This action cannot be undone.")){u(l);try{(await fetch(`/api/v1/api-keys/${l}`,{method:"DELETE",headers:j()})).ok?p():console.error("Failed to delete API key")}catch(h){console.error("Error deleting API key:",h)}finally{u(null)}}},N=l=>new Date(l).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),r=l=>new Date(l).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return g?e.jsx("div",{className:"flex items-center justify-center h-32",children:e.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:"Loading API keys..."})}):t.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-gray-500 dark:text-gray-400 mb-2",children:"No API keys found"}),e.jsx("div",{className:"text-sm text-gray-400 dark:text-gray-500",children:"Create your first API key to get started with external access"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200 dark:border-gray-600",children:[e.jsx("th",{className:"text-left py-2 px-2 sm:py-3 sm:px-4 font-medium text-gray-700 dark:text-gray-300",children:"Name"}),e.jsx("th",{className:"hidden sm:table-cell text-left py-2 px-2 sm:py-3 sm:px-4 font-medium text-gray-700 dark:text-gray-300",children:"Description"}),e.jsx("th",{className:"hidden sm:table-cell text-left py-2 px-2 sm:py-3 sm:px-4 font-medium text-gray-700 dark:text-gray-300",children:"Key Preview"}),e.jsx("th",{className:"hidden sm:table-cell text-left py-2 px-2 sm:py-3 sm:px-4 font-medium text-gray-700 dark:text-gray-300",children:"Created"}),e.jsx("th",{className:"hidden sm:table-cell text-left py-2 px-2 sm:py-3 sm:px-4 font-medium text-gray-700 dark:text-gray-300",children:"Last Used"}),e.jsx("th",{className:"text-right py-2 px-2 sm:py-3 sm:px-4 font-medium text-gray-700 dark:text-gray-300",children:"Actions"})]})}),e.jsx("tbody",{children:t.map(l=>e.jsxs("tr",{className:"border-b border-gray-100 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800/50",children:[e.jsx("td",{className:"py-2 px-2 sm:py-3 sm:px-4",children:e.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:l.name})}),e.jsx("td",{className:"hidden sm:table-cell py-2 px-2 sm:py-3 sm:px-4",children:e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:l.description||"—"})}),e.jsx("td",{className:"hidden sm:table-cell py-2 px-2 sm:py-3 sm:px-4",children:e.jsx("div",{className:"font-mono text-sm text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded",children:l.key_preview})}),e.jsx("td",{className:"hidden sm:table-cell py-2 px-2 sm:py-3 sm:px-4",children:e.jsxs("div",{className:"flex items-center text-sm text-gray-600 dark:text-gray-400",children:[e.jsx(He,{className:"h-4 w-4 mr-1"}),N(l.created_at)]})}),e.jsx("td",{className:"hidden sm:table-cell py-2 px-2 sm:py-3 sm:px-4",children:e.jsx("div",{className:"flex items-center text-sm text-gray-600 dark:text-gray-400",children:l.last_used?e.jsxs(e.Fragment,{children:[e.jsx(Re,{className:"h-4 w-4 mr-1"}),r(l.last_used)]}):"Never"})}),e.jsx("td",{className:"py-2 px-2 sm:py-3 sm:px-4 text-right",children:e.jsx(S,{variant:"ghost",size:"sm",onClick:()=>d(l.id),disabled:f===l.id,className:"text-red-600 hover:text-red-700 hover:bg-red-50 dark:text-red-400 dark:hover:text-red-300 dark:hover:bg-red-900/20",children:e.jsx(G,{className:"h-4 w-4"})})})]},l.id))})]})})}function Xe({open:n,onOpenChange:p,onKeyCreated:t}){const[i,g]=a.useState(""),[m,f]=a.useState(""),[u,j]=a.useState(!1),[x,d]=a.useState(""),{getAuthHeaders:N}=L(),r=async h=>{if(h.preventDefault(),!i.trim()){d("Name is required");return}j(!0),d("");try{const o=await fetch("/api/v1/api-keys/",{method:"POST",headers:{...N(),"Content-Type":"application/json"},body:JSON.stringify({name:i.trim(),description:m.trim()||void 0})});if(o.ok){const s=await o.json(),c={id:s.id.toString(),name:s.name,description:s.description,key:s.key,created_at:new Date().toISOString()};t(c),g(""),f(""),d("")}else{const s=await o.json();d(s.error||"Failed to create API key")}}catch(o){console.error("Error creating API key:",o),d("Failed to create API key. Please try again.")}finally{j(!1)}},l=h=>{u||(p(h),h||(g(""),f(""),d("")))};return e.jsx(X,{open:n,onOpenChange:l,children:e.jsxs(Z,{className:"sm:max-w-md bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[e.jsxs(Q,{children:[e.jsx(ee,{children:"Create New API Key"}),e.jsx(ae,{children:"Create a new API key for external access to Scriberr. Give it a descriptive name to help you identify it later."})]}),e.jsxs("form",{onSubmit:r,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"name",children:"Name *"}),e.jsx(A,{id:"name",placeholder:"e.g., My App Integration",value:i,onChange:h=>g(h.target.value),maxLength:100,disabled:u}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"A friendly name to identify this API key"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"description",children:"Description"}),e.jsx(we,{id:"description",placeholder:"Optional description of what this key will be used for",value:m,onChange:h=>f(h.target.value),rows:3,disabled:u})]}),x&&e.jsx("div",{className:"text-sm text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-900/20 p-3 rounded-lg",children:x}),e.jsxs(se,{children:[e.jsx(S,{type:"button",variant:"outline",onClick:()=>l(!1),disabled:u,children:"Cancel"}),e.jsx(S,{type:"submit",disabled:u||!i.trim(),className:"bg-blue-600 hover:bg-blue-700 text-white",children:u?"Creating...":"Create API Key"})]})]})]})})}function Ze({open:n,onOpenChange:p,apiKey:t,onClose:i}){const[g,m]=a.useState(!1),f=async()=>{if(t?.key)try{await navigator.clipboard.writeText(t.key),m(!0),setTimeout(()=>m(!1),2e3)}catch(x){console.error("Failed to copy to clipboard:",x);const d=document.createElement("textarea");d.value=t.key,document.body.appendChild(d),d.select(),document.execCommand("copy"),document.body.removeChild(d),m(!0),setTimeout(()=>m(!1),2e3)}},u=()=>{m(!1),i()},j=x=>{x||u(),p(x)};return t?e.jsx(X,{open:n,onOpenChange:j,children:e.jsxs(Z,{className:"sm:max-w-lg bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[e.jsxs(Q,{children:[e.jsxs(ee,{className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-5 w-5 text-green-600"}),"API Key Created Successfully"]}),e.jsx(ae,{children:"Your API key has been created. Copy it now and store it securely - you won't be able to see the full key again."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(qe,{className:"h-5 w-5 text-yellow-600 dark:text-yellow-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:[e.jsx("div",{className:"font-medium mb-1",children:"Important Security Notice"}),e.jsx("div",{children:"This is the only time you'll see the full API key. Make sure to copy and store it in a secure location before closing this dialog."})]})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx(w,{className:"text-sm font-medium",children:"Name"}),e.jsx("div",{className:"text-gray-900 dark:text-gray-100 mt-1",children:t.name})]}),t.description&&e.jsxs("div",{children:[e.jsx(w,{className:"text-sm font-medium",children:"Description"}),e.jsx("div",{className:"text-gray-600 dark:text-gray-400 mt-1",children:t.description})]}),e.jsxs("div",{children:[e.jsx(w,{htmlFor:"api-key",className:"text-sm font-medium",children:"API Key"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(A,{id:"api-key",value:t.key,readOnly:!0,className:"font-mono text-sm bg-gray-50 dark:bg-gray-800",onClick:x=>x.target.select()}),e.jsx(S,{onClick:f,size:"sm",variant:"outline",className:"flex-shrink-0",disabled:g,children:g?e.jsx(q,{className:"h-4 w-4 text-green-600"}):e.jsx(ze,{className:"h-4 w-4"})})]}),g&&e.jsx("div",{className:"text-sm text-green-600 dark:text-green-400 mt-1",children:"Copied to clipboard!"})]}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-3",children:e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[e.jsx("div",{className:"font-medium mb-1",children:"Usage Example:"}),e.jsxs("div",{className:"font-mono text-xs bg-white dark:bg-gray-900 p-2 rounded border",children:['curl -H "X-API-Key: ',t.key,'" http://localhost:8080/api/v1/...']})]})})]})]}),e.jsx(se,{children:e.jsx(S,{onClick:u,className:"w-full",children:"I've Saved My API Key"})})]})}):null}function Qe(){const[n,p]=a.useState(!1),[t,i]=a.useState(!1),[g,m]=a.useState(null),[f,u]=a.useState(0),j=a.useCallback(()=>{p(!0)},[]),x=a.useCallback(async r=>{m(r),p(!1),i(!0),u(l=>l+1)},[]),d=a.useCallback(()=>{u(r=>r+1)},[]),N=a.useCallback(()=>{i(!1),m(null)},[]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-xl p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-0 mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:"API Keys"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Manage your API keys for external access to Scriberr."})]}),e.jsx(S,{onClick:j,className:"bg-blue-600 hover:bg-blue-700 text-white",children:"Create New API Key"})]}),e.jsx(Ge,{refreshTrigger:f,onKeyChange:d})]}),e.jsx(Xe,{open:n,onOpenChange:p,onKeyCreated:x}),e.jsx(Ze,{open:t,onOpenChange:i,apiKey:g,onClose:N})]})}function ea(){const[n,p]=a.useState({provider:"ollama",is_active:!1}),[t,i]=a.useState(""),[g,m]=a.useState(""),[f,u]=a.useState(!0),[j,x]=a.useState(!1),[d,N]=a.useState(null),{getAuthHeaders:r}=L();a.useEffect(()=>{l()},[]);const l=async()=>{try{const s=await fetch("/api/v1/llm/config",{headers:r()});if(s.ok){const c=await s.json();p(c),i(c.base_url||"")}else s.status!==404&&console.error("Failed to fetch LLM config")}catch(s){console.error("Error fetching LLM config:",s)}finally{u(!1)}},h=async()=>{x(!0),N(null);const s={provider:n.provider,is_active:!0,...n.provider==="ollama"&&{base_url:t},...n.provider==="openai"&&{api_key:g}};try{const c=await fetch("/api/v1/llm/config",{method:"POST",headers:{...r(),"Content-Type":"application/json"},body:JSON.stringify(s)});if(c.ok){const y=await c.json();p(y),N({type:"success",text:"LLM configuration saved successfully!"}),n.provider==="openai"&&m("")}else{const y=await c.json();N({type:"error",text:y.error||"Failed to save configuration"})}}catch(c){console.error("Error saving LLM config:",c),N({type:"error",text:"Failed to save configuration. Please try again."})}finally{x(!1)}},o=()=>n.provider==="ollama"?t.trim()!=="":n.provider==="openai"?g.trim()!==""||n.has_api_key:!1;return f?e.jsx("div",{className:"flex items-center justify-center h-32",children:e.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:"Loading LLM configuration..."})}):e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-xl p-4 sm:p-6",children:[e.jsxs("div",{className:"mb-4 sm:mb-6",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 flex items-center gap-2",children:[e.jsx(V,{className:"h-5 w-5"}),"LLM Configuration"]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Configure external Large Language Model integration for enhanced features."})]}),d&&e.jsxs("div",{className:`mb-4 sm:mb-6 p-3 sm:p-4 rounded-lg flex items-center gap-2 ${d.type==="success"?"bg-green-50 dark:bg-green-900/20 text-green-800 dark:text-green-200":"bg-red-50 dark:bg-red-900/20 text-red-800 dark:text-red-200"}`,children:[d.type==="success"?e.jsx(ce,{className:"h-4 w-4"}):e.jsx(me,{className:"h-4 w-4"}),d.text]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(w,{className:"text-base font-medium",children:"Choose LLM Provider"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:"Select the LLM service you want to integrate with"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("label",{htmlFor:"ollama",children:e.jsxs(re,{className:`cursor-pointer transition-colors ${n.provider==="ollama"?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"hover:bg-gray-50 dark:hover:bg-gray-600"}`,children:[e.jsx(le,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",id:"ollama",name:"provider",value:"ollama",checked:n.provider==="ollama",onChange:s=>p({...n,provider:s.target.value}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500"}),e.jsx(V,{className:"h-5 w-5"}),e.jsx(ne,{className:"text-base",children:"Ollama"})]})}),e.jsx(ie,{children:e.jsx(de,{children:"Local LLM server. Requires Ollama installation."})})]})}),e.jsx("label",{htmlFor:"openai",children:e.jsxs(re,{className:`cursor-pointer transition-colors ${n.provider==="openai"?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"hover:bg-gray-50 dark:hover:bg-gray-600"}`,children:[e.jsx(le,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",id:"openai",name:"provider",value:"openai",checked:n.provider==="openai",onChange:s=>p({...n,provider:s.target.value}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500"}),e.jsx(Je,{className:"h-5 w-5"}),e.jsx(ne,{className:"text-base",children:"OpenAI"})]})}),e.jsx(ie,{children:e.jsx(de,{children:"OpenAI's cloud API. Requires API key."})})]})})]})]}),e.jsxs("div",{className:"space-y-4",children:[n.provider==="ollama"&&e.jsxs("div",{children:[e.jsx(w,{htmlFor:"baseUrl",children:"Ollama Base URL *"}),e.jsx(A,{id:"baseUrl",type:"url",placeholder:"http://localhost:11434",value:t,onChange:s=>i(s.target.value),className:"mt-1"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"The URL where your Ollama server is running"})]}),n.provider==="openai"&&e.jsxs("div",{children:[e.jsxs(w,{htmlFor:"apiKey",className:"flex items-center gap-2",children:[e.jsx(Se,{className:"h-4 w-4"}),"OpenAI API Key *",n.has_api_key&&e.jsx("span",{className:"text-xs bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 px-2 py-1 rounded",children:"Already configured"})]}),e.jsx(A,{id:"apiKey",type:"password",placeholder:n.has_api_key?"Enter new API key to update":"sk-...",value:g,onChange:s=>m(s.target.value),className:"mt-1"}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Your OpenAI API key. ",n.has_api_key?"Leave blank to keep current key.":""]})]})]}),n.id&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Status"}),e.jsx("div",{className:"flex items-center gap-2",children:n.is_active?e.jsxs(e.Fragment,{children:[e.jsx(ce,{className:"h-4 w-4 text-green-600"}),e.jsxs("span",{className:"text-sm text-green-700 dark:text-green-300",children:["Active configuration for ",n.provider]})]}):e.jsxs(e.Fragment,{children:[e.jsx(me,{className:"h-4 w-4 text-yellow-600"}),e.jsx("span",{className:"text-sm text-yellow-700 dark:text-yellow-300",children:"Configuration saved but not active"})]})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(S,{onClick:h,disabled:!o()||j,className:"bg-blue-600 hover:bg-blue-700 text-white",children:j?"Saving...":"Save Configuration"})})]})]})})}function aa({open:n,onOpenChange:p,onSave:t,initial:i}){const[g,m]=a.useState(""),[f,u]=a.useState(""),[j,x]=a.useState(""),[d,N]=a.useState(""),[r,l]=a.useState(!1),[h,o]=a.useState([]),{getAuthHeaders:s}=L();a.useEffect(()=>{n&&(m(i?.name||""),u(i?.description||""),x(i?.model||""),N(i?.prompt||""),(async()=>{try{const y=await fetch("/api/v1/chat/models",{headers:{...s()}});if(y.ok){const D=await y.json();o(D.models||[]),!i?.model&&(D.models||[]).length&&x(D.models[0])}}catch{}})())},[n,i]);const c=async()=>{if(!(!g.trim()||!d.trim()||!j.trim()))try{l(!0),await t({id:i?.id,name:g.trim(),description:f.trim()||void 0,model:j.trim(),prompt:d.trim()}),p(!1)}finally{l(!1)}};return e.jsx(X,{open:n,onOpenChange:p,children:e.jsxs(Z,{className:"sm:max-w-xl md:max-w-2xl lg:max-w-3xl xl:max-w-4xl max-h-[90vh] md:max-h-[92vh] overflow-y-auto bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:[e.jsxs(Q,{children:[e.jsx(ee,{className:"text-gray-900 dark:text-gray-100",children:i?"Edit Summary Template":"New Summary Template"}),e.jsx(ae,{className:"text-gray-600 dark:text-gray-400",children:"Define a reusable prompt to summarize transcripts."})]}),e.jsxs("div",{className:"space-y-4 py-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{className:"text-gray-700 dark:text-gray-300",children:"Name"}),e.jsx(A,{value:g,onChange:y=>m(y.target.value),placeholder:"e.g., Concise Bullet Summary"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{className:"text-gray-700 dark:text-gray-300",children:"Model"}),e.jsxs(Pe,{value:j,onValueChange:x,children:[e.jsx(Ae,{className:"bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100",children:e.jsx(De,{placeholder:h.length?"Select model":"No models available"})}),e.jsx(Te,{className:"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 max-h-60",children:h.map(y=>e.jsx(Le,{value:y,className:"text-gray-900 dark:text-gray-100 focus:bg-gray-100 dark:focus:bg-gray-700",children:y},y))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{className:"text-gray-700 dark:text-gray-300",children:"Description (optional)"}),e.jsx(A,{value:f,onChange:y=>u(y.target.value),placeholder:"Short description"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{className:"text-gray-700 dark:text-gray-300",children:"Prompt"}),e.jsx(we,{rows:10,className:"resize-y min-h-40 sm:min-h-60 md:min-h-72 lg:min-h-[50vh] max-h-[65vh]",value:d,onChange:y=>N(y.target.value),placeholder:"Write the summarization instructions..."})]})]}),e.jsxs(se,{children:[e.jsx(S,{variant:"outline",onClick:()=>p(!1),children:"Cancel"}),e.jsx(S,{onClick:c,disabled:r||!g.trim()||!d.trim()||!j.trim(),className:"bg-blue-600 hover:bg-blue-700 text-white dark:bg-blue-600 dark:hover:bg-blue-500",children:r?"Saving...":"Save"})]})]})})}function sa({onEdit:n,refreshTrigger:p=0,disabled:t=!1}){const{getAuthHeaders:i}=L(),[g,m]=a.useState([]),[f,u]=a.useState(!0),[j,x]=a.useState({}),[d,N]=a.useState(new Set),r=a.useCallback(async()=>{try{u(!0);const o=await fetch("/api/v1/summaries",{headers:{...i()}});if(o.ok){const s=await o.json();m(s)}}finally{u(!1)}},[]);a.useEffect(()=>{r()},[r,p]);const l=async o=>{x(s=>({...s,[o]:!1}));try{N(c=>new Set(c).add(o)),(await fetch(`/api/v1/summaries/${o}`,{method:"DELETE",headers:{...i()}})).ok?m(c=>c.filter(y=>y.id!==o)):alert("Failed to delete")}finally{N(s=>{const c=new Set(s);return c.delete(o),c})}},h=o=>o?new Date(o).toLocaleString():"";return f?e.jsx("div",{className:"space-y-2",children:[...Array(3)].map((o,s)=>e.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 rounded-lg p-4 animate-pulse h-16"},s))}):g.length===0?e.jsxs("div",{className:`text-center py-16 ${t?"opacity-60 pointer-events-none":""}`,children:[e.jsx("div",{className:"bg-gray-100 dark:bg-gray-700 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx(Y,{className:"h-8 w-8 text-gray-400 dark:text-gray-500"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"No summary templates"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6 max-w-sm mx-auto",children:"Create your first summarization template to reuse your prompt."})]}):e.jsx("div",{className:`space-y-2 ${t?"opacity-60 pointer-events-none":""}`,children:g.map(o=>e.jsx("div",{className:"group bg-gray-100 dark:bg-gray-700 rounded-lg p-4 hover:bg-gray-200 dark:hover:bg-gray-600 transition-all duration-200 cursor-pointer",onClick:()=>!t&&n(o),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"bg-gray-200 dark:bg-gray-800 rounded-md p-1.5",children:e.jsx(Y,{className:"h-3.5 w-3.5 text-gray-500 dark:text-gray-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:o.name}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 whitespace-nowrap",children:h(o.created_at)})]}),o.description&&e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate mt-1",children:o.description})]})]}),e.jsx("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity duration-200",onClick:s=>s.stopPropagation(),children:!t&&e.jsxs(ve,{open:j[o.id]||!1,onOpenChange:s=>x(c=>({...c,[o.id]:s})),children:[e.jsx(Ne,{asChild:!0,children:e.jsx(S,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 hover:bg-gray-300 dark:hover:bg-gray-600",children:"⋮"})}),e.jsx(ke,{className:"w-32 bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-600 p-1",children:e.jsxs(ge,{children:[e.jsx(xe,{asChild:!0,children:e.jsxs(S,{variant:"ghost",size:"sm",className:"w-full justify-start h-7 text-xs hover:bg-gray-100 dark:hover:bg-gray-700 text-red-500 dark:text-red-400 hover:text-red-600 dark:hover:text-red-300",disabled:d.has(o.id),children:[e.jsx(G,{className:"mr-2 h-3 w-3"})," Delete"]})}),e.jsxs(he,{className:"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:[e.jsxs(ye,{children:[e.jsx(ue,{className:"text-gray-900 dark:text-gray-100",children:"Delete Template"}),e.jsxs(pe,{className:"text-gray-600 dark:text-gray-400",children:['Are you sure you want to delete "',o.name,'"?']})]}),e.jsxs(fe,{children:[e.jsx(be,{className:"bg-gray-100 dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-600",children:"Cancel"}),e.jsx(je,{className:"bg-red-600 text-white hover:bg-red-700",onClick:()=>l(o.id),children:"Delete"})]})]})]})})]})})]})},o.id))})}function ma(){const[n,p]=a.useState("transcription"),{getAuthHeaders:t}=L(),[i,g]=a.useState(!1),[m,f]=a.useState(null),[u,j]=a.useState(0),[x,d]=a.useState(!1);a.useEffect(()=>{(async()=>{try{const l=await fetch("/api/v1/llm/config",{headers:{...t()}});if(!l.ok){d(!1);return}const h=await l.json();d(!!h&&h.is_active),h&&h.is_active&&d(!0)}catch{d(!1)}})()},[n,t]);const N=()=>{};return e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:e.jsxs("div",{className:"mx-auto w-full max-w-6xl px-2 sm:px-6 md:px-8 py-3 sm:py-6",children:[e.jsx(Ee,{onFileSelect:N}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-2 sm:p-6 mt-4 sm:mt-6",children:[e.jsxs("div",{className:"mb-4 sm:mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100 mb-2",children:"Settings"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Manage your account settings and transcription profiles."})]}),e.jsxs(Fe,{value:n,onValueChange:p,className:"space-y-4 sm:space-y-6",children:[e.jsxs(Ue,{className:"grid w-full grid-cols-5 items-center h-auto bg-gray-100 dark:bg-gray-800 p-1 rounded-xl",children:[e.jsxs(_,{value:"transcription","aria-label":"Transcription",className:"flex items-center justify-center gap-2 h-9 py-1.5 data-[state=active]:bg-white dark:data-[state=active]:bg-gray-700 data-[state=active]:text-gray-900 dark:data-[state=active]:text-gray-100 text-gray-600 dark:text-gray-400 font-medium rounded-lg text-xs sm:text-sm",children:[e.jsx(W,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Transcription"})]}),e.jsxs(_,{value:"account","aria-label":"Account",className:"flex items-center justify-center gap-2 h-9 py-1.5 data-[state=active]:bg-white dark:data-[state=active]:bg-gray-700 data-[state=active]:text-gray-900 dark:data-[state=active]:text-gray-100 text-gray-600 dark:text-gray-400 font-medium rounded-lg text-xs sm:text-sm",children:[e.jsx(Ce,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Account"})]}),e.jsxs(_,{value:"apikeys","aria-label":"API Keys",className:"flex items-center justify-center gap-2 h-9 py-1.5 data-[state=active]:bg-white dark:data-[state=active]:bg-gray-700 data-[state=active]:text-gray-900 dark:data-[state=active]:text-gray-100 text-gray-600 dark:text-gray-400 font-medium rounded-lg text-xs sm:text-sm",children:[e.jsx(Se,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"API Keys"})]}),e.jsxs(_,{value:"llms","aria-label":"LLMs",className:"flex items-center justify-center gap-2 h-9 py-1.5 data-[state=active]:bg-white dark:data-[state=active]:bg-gray-700 data-[state=active]:text-gray-900 dark:data-[state=active]:text-gray-100 text-gray-600 dark:text-gray-400 font-medium rounded-lg text-xs sm:text-sm",children:[e.jsx(V,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"LLMs"})]}),e.jsxs(_,{value:"summary","aria-label":"Summary",className:"flex items-center justify-center gap-2 h-9 py-1.5 data-[state=active]:bg-white dark:data-[state=active]:bg-gray-700 data-[state=active]:text-gray-900 dark:data-[state=active]:text-gray-100 text-gray-600 dark:text-gray-400 font-medium rounded-lg text-xs sm:text-sm",children:[e.jsx(Y,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Summary"})]})]}),e.jsx(M,{value:"transcription",className:"space-y-6",children:e.jsx(Ye,{})}),e.jsx(M,{value:"account",className:"space-y-6",children:e.jsx(We,{})}),e.jsx(M,{value:"apikeys",className:"space-y-6",children:e.jsx(Qe,{})}),e.jsx(M,{value:"llms",className:"space-y-6",children:e.jsx(ea,{})}),e.jsxs(M,{value:"summary",className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-xl p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-0 mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:"Summarization Templates"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Create and manage prompts used to summarize transcripts."})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("button",{onClick:()=>{f(null),g(!0)},disabled:!x,className:`inline-flex items-center gap-2 px-3 py-2 rounded-md cursor-pointer ${x?"bg-blue-600 hover:bg-blue-700 text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:[e.jsx(Be,{className:"h-4 w-4"})," New Template"]})})]}),!x&&e.jsx("div",{className:"mb-3 text-sm text-gray-700 dark:text-gray-300 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-md px-3 py-2",children:"Configure an LLM provider in the LLMs tab to enable summary templates and model selection."}),e.jsx(sa,{onEdit:r=>{f(r),g(!0)},refreshTrigger:u,disabled:!x})]}),e.jsx(aa,{open:i,onOpenChange:r=>{g(r),r||f(null)},initial:m,onSave:async r=>{const l={"Content-Type":"application/json",...t()};try{r.id?await fetch(`/api/v1/summaries/${r.id}`,{method:"PUT",headers:l,body:JSON.stringify({name:r.name,description:r.description,model:r.model,prompt:r.prompt})}):await fetch("/api/v1/summaries",{method:"POST",headers:l,body:JSON.stringify({name:r.name,description:r.description,model:r.model,prompt:r.prompt})})}finally{g(!1),f(null),j(h=>h+1)}}})]})]})]})]})})}export{ma as Settings};
